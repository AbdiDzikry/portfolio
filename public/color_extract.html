<!DOCTYPE html>
<html>

<body>
    <img id="img" src="/profile/abdi.jpg" style="display:none;" />
    <canvas id="canvas"></canvas>
    <div id="output">Loading...</div>

    <script>
        window.onload = function () {
            const img = document.getElementById('img');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');

            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);

            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            let r = 0, g = 0, b = 0;
            let count = 0;

            // Simple average for now suitable for base tone
            for (let i = 0; i < data.length; i += 4) {
                // Skip transparent or white-ish pixels to get the "subject" color
                if (data[i] > 240 && data[i + 1] > 240 && data[i + 2] > 240) continue;

                r += data[i];
                g += data[i + 1];
                b += data[i + 2];
                count++;
            }

            r = Math.floor(r / count);
            g = Math.floor(g / count);
            b = Math.floor(b / count);

            const hex = "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            document.getElementById('output').innerText = "DOMINANT_COLOR:" + hex;
        }
    </script>
</body>

</html>